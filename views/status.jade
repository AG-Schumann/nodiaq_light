extends layout

block extrahead
  script(src="javascripts/moment.min.js", type="text/javascript")
  script(src="javascripts/status_script.js", type="text/javascript")
  link(href="stylesheets/status_style.css", rel="stylesheet")

block content
  - var readers = ["reader0_reader_0", "reader1_reader_1", 'reader2_reader_2', 'reader3_reader_3', 'reader4_reader_4', 'reader6_reader_6', 'reader7_reader_7'];
  - var controllers = ["reader0_controller_0"];
  - var brokers = [];  // ["fdaq00_broker_0_tpc", "fdaq00_broker_0_muon_veto", "fdaq00_broker_0_neutron_veto"];
  - var atts = ['active', 'comment', 'detector', 'hosts', 'crate_controller', 'diagnosis', 'mode', 'number', 'started_at', 'status', 'stop_after', 'user'];
  - var controller_atts = ['host', 'status', 'checkin'];
  - var controller_labels = ['Host', 'Status', 'Check-in'];
  div.main-container.container-fluid

      div.row(style="width:100%;")
        div.col-sm-12.col-md-12.col-lg-6(style="padding:5px;border:1px solid #ccc")
          div(style="width:100%;border-bottom:1px solid #ccc")
            h5 Recent Dispatcher Commands
          div.panel-group#command_panel
        each controller in controllers
          div.col-sm-12.col-md-12.col-lg-3.command_panel.fontscale(style="padding:5px;border:1px solid #ccc")
            h5 Crate Controller
            table.table.table-condensed(style="width:100%;margin:0")
              each value, index in controller_atts
                tr
                  td(style="padding:0")
                    strong #{controller_labels[index]}:
                  td(style="padding:0")
                    span(id="#{controller}_#{value}")
            hr(style="margin:0")
            strong Devices:
            ul(id="#{controller}_devices")
          
      each reader in readers      
        div.row.reader_detail
          div.col-sm-12.col-md-12.col-lg-3(style="padding:5px;")
            table.table.table-condensed.fontscale(style="width:100%;height:100%;margin:0")
              tr
                td(style="padding:0")
                  strong Node:
                td(style="padding:0")
                  strong(style="color:#2a5935") #{reader}
              tr
                td(style="padding:0")
                  strong Status: 
                td(style="padding:0")
                  span(id="#{reader}_status")
              tr
                td(style="padding:0")
                  strong Rate:  
                td(style="padding:0")
                  span(id="#{reader}_rate")
              tr
                td(style="padding:0")
                  strong Buffer Size:  
                td(style="padding:0")
                  span(id="#{reader}_buffer")
              tr
                td(style="padding:0")
                  strong Mode:  
                td(style="padding:0")  
                  span(id="#{reader}_mode")
              tr
                td(style="padding:0")
                  strong Run:  
                td(style="padding:0")
                  span(id="#{reader}_run")
              tr
                td(style="padding:0")
                  strong Check-in:  
                td(style="padding:0")
                  span(id="#{reader}_check-in")
          div.col-sm-12.col-md-12.col-lg.9(style="overflow-x:hidden")
            div.reader_chartdiv(id="#{reader}_chartdiv")
  script.
    var readers = ["fdaq00_reader_0", "fdaq00_reader_1"];
    $(document).ready(function () {
      DrawInitialCharts();
      UpdateStatusPage();
      DrawActiveLink("#lstatus");
    });
      
    